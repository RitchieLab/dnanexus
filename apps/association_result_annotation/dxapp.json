{
  "name": "association_result_annotation",
  "title": "Annotate GWAS, PheWAS Associations",
  "summary": "This app increases the number of annotations in an input GWAS tsv file.",
  "dxapi": "1.0.0",
  "version": "0.0.1",
  "categories": [],
  "inputSpec": [
    {
      "name": "input_file",
      "label": "Input Assocaition File",
      "class": "file",
      "optional": false,
      "patterns": ["*.tsv"],
      "help": "A genome wide association file in."
    },
    {
      "name": "sql_db_file",
      "label": "SQLite databse file",
      "class": "file",
      "patterns": ["*.db"],
      "hidden": true,
      "help": "A SQLite3 databse file.",
      "default": {
        "$dnanexus_link":
        {
          "project": "project-BYpFk1Q0pB0xzQY8ZxgJFv1V",
          "id": "file-BxGpVYQ0pB0vZkV6g5JVgz9F"
      }
      }
    },
    {
      "name": "icd9_desc",
      "label": "Do you want to add ICD-9 descriptions?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "ICD-9 Description",
      "help": "(Optional) Allows to add ICD-9 code long descriptions to the output."
    },
    {
      "name": "icd9_col",
      "label": "Is there a column in the input file which contains ICD-9 codes?",
      "help" : "(Optional) Indicates which column in input file contains ICD-9 codes. It is required if icd9_desc is set to true.",
      "class": "string",
      "optional": true,
      "group": "ICD-9 Description"
    },
    { "name": "ebi_gwas",
      "label": "Do you want to add traits found in the the EBI GWAS catalog?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Gene and GWAS Catalog",
      "help": "(Optional) Add traits found in EBI GWAS catalog for SNPs position in input file."
    },
    { "name": "grasp",
      "label": "Do you want to add traits found in the GRASP GWAS catalog for SNPs in the input file?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Gene and GWAS Catalog",
      "help": "(Optional) GRASP has more thorough list of published GWAS results but it also include results with p-value < 0.01 and that makes it a bigger database than EBI."
    },
    { "name": "grasp_pval",
      "label": "GRASP p-value threshold",
      "help": "(Optional) Because GRASP reports association from known GWAS with pvalue < 0.01, we suggest to use a lower significance (<1E-05) to reduce result lookup.",
      "class": "string",
      "default": "0.00001",
      "optional": true,
      "group": "Gene and GWAS Catalog"
    },
    {
      "name": "or_val",
      "label": "Do you want to calculate the odds ratio from the beta and standard error in the input file?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Statistics (Only works with PLATO output)",
      "help": "(Optional) odds ratio and confidence interval calculated from the beta and standard error."
    },
    {
      "name": "case_control_num",
      "label": "Do you want to include case-control numbers in the output file?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Statistics (Only works with PLATO output)",
      "help": "(Optional) Listing case-control numbers only works with output from PLATO."
    },
    {
      "name": "gene",
      "label": "Do you want to map genes to chromosome-basepair positions from the input data?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Gene and GWAS Catalog",
      "help": "(Optional) Map gene to chromosome-basepair position in input file."
    },
    {
      "name": "up_gene",
      "label": "Do you want to map upstream genes to chromosome-basepair position in the input file and provide the distances to the SNPs?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Gene and GWAS Catalog",
      "help": "(Optional) Maps upstream genes to chromosome-basepair position in input file and provides distances to SNPs."
    },
    {
      "name": "down_gene",
      "label": "Do you want to map downstream genes to chromosome-basepair positions in the input file and provide distances to the SNPs?",
      "class": "boolean",
      "default": false,
      "optional": true,
      "group": "Gene and GWAS Catalog",
      "help": "(Optional) Maps downstream genes to chromosome-basepair position in the input file and provides distances to SNPs."
    },
    {
      "name": "chr_col",
      "label": "Do you want to provide the column name that contains chromosome numbers in the input file?",
      "help" : "(Optional) It is required if any of the option in Gene and GWAS Catalog is true. It allows app to know which column in input file contain chromosome numbers. In case of PLATO association results output, just enter 'Var1_Pos'.",
      "class": "string",
      "optional": true,
      "group": "Gene and GWAS Catalog"
    },
    {
      "name": "pos_col",
      "label": "Do you want to provide column name that contains basepair postion of a SNP in the input file?",
      "help" : "(Optional) It is required if any of the option in Gene and GWAS Catalog is true. It allows app to know which column in input file contain basepair position. In case of PLATO association results output, just enter 'Var1_Pos'.",
      "class": "string",
      "optional": true,
      "group": "Gene and GWAS Catalog"
    }
  ],
  "outputSpec": [
    {
      "name": "out_file",
      "label": "Output File",
      "class": "file",
      "help": "The output file contains columns from the input file with additional columns requested for annotation."
    }
  ],
  "runSpec": {
    "execDepends": [
      {"name": "python-apsw"}
    ],
    "interpreter": "bash",
    "file": "src/association_result_annotation.sh",
    "timeoutPolicy": {
      "main": { 
        "hours": 12  
      },
      "*": {
        "hours": 4,
        "minutes": 30
      }
    }
   },
   "regionalOptions": {
    "aws:us-east-1": {
      "systemRequirements": {
        "*": {
          "instanceType": "mem1_ssd1_x4"
        }   
      },  
      "assetDepends": [
          {   
            "id":"record-FGkqfp801VfbYYq126ff8Fz2"
          }   
       ]   
      }   
  },
  "access": {
    "project": "CONTRIBUTE"
  },
   "developers" : ["user-auv13", "user-atf3"],
   "authorizedUsers": ["org-geisinger_affiliate", "org-geisinger", "org-geisinger_devel", "org-emerge_geisinger"]
}
